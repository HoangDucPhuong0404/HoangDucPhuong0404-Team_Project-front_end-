define(['underscore','jquery','uiRegistry','Magento_Ui/js/form/element/select','Magento_Checkout/js/model/quote','Magento_Checkout/js/model/shipping-rate-processor/new-address','Magento_Checkout/js/model/shipping-rate-processor/customer-address','Magento_Checkout/js/model/shipping-rate-registry'],function(_,$,registry,Select,quote,defaultProcessor,customerAddressProcessor,rateRegistry){'use strict';return Select.extend({defaults:{skipValidation:false,captionValue:'tn',imports:{update:'${ $.parentName }.district_id:value'}},setDifferedFromDefault:function(){this._super();registry.async(this.parentName+'.'+'ward')(function(element){element.setVisible(false);});},onUpdate:function(){var self=this,option=_.find(this.options(),function(item){return item.value==self.value();});if(!_.isUndefined(option)){this.source.set(this.dataScope.replace('_id',''),option.full_name);self.estimateShippingMethods();}},estimateShippingMethods:function(){var processors={},type=quote.shippingAddress().getType(),shippingAddress=quote.shippingAddress();processors.default=defaultProcessor;processors['customer-address']=customerAddressProcessor;rateRegistry.get(shippingAddress.getCacheKey())
rateRegistry.set(shippingAddress.getCacheKey(),false);shippingAddress.countryId='VN';let updateCityId=$('select[name=city_id] :selected').val(),updateDistrictId=$('select[name=district_id] :selected').val(),updateWardId=$('select[name=ward_id] :selected').val();let updatedValue={customAttributes:{city_id:updateCityId,district_id:updateDistrictId,ward_id:updateWardId}};let updateShippingAddress=quote.shippingAddress();updateShippingAddress=$.extend({},quote.shippingAddress(),updatedValue)
if(processors[type]){processors[type].getRates(updateShippingAddress);}else{processors.default.getRates(updateShippingAddress);}},});});